# download hits from blast query
# create python loop to separate proteins from hits, using locations
# use python script to filter out low quality alignments (using E value 10^10)
# dos2windows on files to make sure in correct format
# use vim to check \\t annotations

#run on command line (no script)
bedtoools subtract proteins.txt blastlocations.txt > ../results/subtracted areas

module load nano
module load bedtools intersect
mkdir input
mkdir results
### @input ####
300419_hits.txt #file dowloaded from NCBI Blast hits
#use Proteins.pynb tool to extract protein locations from hit table.
300419_proteins.txt #protein locations table.
300419_protein_corrected.txt #from previous file - just kept scaffold
column and coordinates.
awk '{OFS="\t"; if ($3>$2) {print} else {print $1,$3,$2}}'300419_protein_corrected.txt >
300419_proteins_corrected.bed #to reorder reverse andOOforward strand in
ascending
columns
dos2unix 300419_proteins_corrected.bed #to convert windows file into unix
file
vim 300419_proteins_corrected.bed
%s/^M/ #use vim to remove '^M' (ctrl V + shift M to get right format)

300419_blast.txt #contains just blast hits, generated using python tool
300419_filtered2.txt #file contains just scaffold,identity and positions
awk '{OFS="\t"; if ($2>55) {print}}' 300419_filtered2.txt
>300419_50_filtered.txt #to filter positions with over 55% identity
 awk '{OFS="\t"; if ($4>$3){print $1,$3,$4} else {print $1,$4,$3}}'
300419_50_filtered.txt > 300419_corrected.bed #ro reorder columns
dos2unix 300419_corrected.bed #to convert windows file to UNIX
vim 300419_corrected.bed
%s/^M/ #in vim to remove ^M

bedtools subtract -f 0.5 -a 300419_proteins_corrected.bed -b
300419_corrected.bed > ../results/300419_subtracted_areas.bed #bedtools
subract with only >50% overlap
